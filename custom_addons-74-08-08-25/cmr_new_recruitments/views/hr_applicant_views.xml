<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="view_hr_applicant_form_custom" model="ir.ui.view">
        <field name="name">hr.applicant.form.name.aadhaar</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <!-- Request Approval -->
                <button name="action_request_approval"
                        string="Request For Job Offer Approval"
                        type="object"
                        class="btn-primary"
                        invisible="not is_stage_initial"
                        groups="hr_recruitment.group_hr_recruitment_manager"/>
                <!-- Approve Level 1 -->
                <button name="action_first_approve"
                        string="Approve"
                        type="object"
                        class="btn-success"
                        invisible="approval_stage not in ['first_requested']"
                        groups="cmr_new_recruitments.group_hr_applicant_first_approval"/>
                <!-- Approve Level 2 -->
                <button name="action_second_approve"
                        string="Approve"
                        type="object"
                        class="btn-success"
                        invisible="approval_stage not in ['first_approved']"
                        groups="cmr_new_recruitments.group_hr_applicant_second_approval"/>
                <button name="action_refuse_approval_one"
                        string="Refuse"
                        type="object"
                        class="btn-danger"
                        invisible="approval_stage not in ['first_requested']"
                        groups="cmr_new_recruitments.group_hr_applicant_first_approval"/>

                <button name="action_refuse_approval_two"
                        string="Refuse"
                        type="object"
                        class="btn-danger"
                        invisible="approval_stage not in ['first_approved']"
                        groups="cmr_new_recruitments.group_hr_applicant_second_approval"/>


                <button name="action_appointment_request_approval"
                        string="Request For Appointment Offer Approval"
                        type="object"
                        class="btn-primary"
                        invisible="approval_stage not in ['first_approved_offer']"
                        groups="hr_recruitment.group_hr_recruitment_manager"/>

                <!-- Approve Level 1 -->
                <button name="action_appointment_first_approve"
                        string="Approve"
                        type="object"
                        class="btn-success"
                        invisible="approval_stage not in ['second_approved_offer']"
                        groups="cmr_new_recruitments.group_hr_applicant_first_approval"/>

                <!-- Approve Level 2 -->
                <button name="action_appointment_second_approve"
                        string="Approve"
                        type="object"
                        class="btn-success"
                        invisible="approval_stage not in ['third_approved_offer']"
                        groups="cmr_new_recruitments.group_hr_applicant_second_approval"/>

                <button name="action_appointment_refuse_approval_one"
                        string="Refuse"
                        type="object"
                        class="btn-danger"
                        invisible="approval_stage not in ['second_approved_offer']"
                        groups="cmr_new_recruitments.group_hr_applicant_first_approval"/>

                <button name="action_appointment_refuse_approval_two"
                        string="Refuse"
                        type="object"
                        class="btn-danger"
                        invisible="approval_stage not in ['third_approved_offer']"
                        groups="cmr_new_recruitments.group_hr_applicant_second_approval"/>


            </xpath>
            <xpath expr="//button[@name='archive_applicant']" position="before">
                <button name="action_open_checklist_tab" string="Check List" type="object" class="btn-primary"
                        invisible="approval_stage not in ['checklist']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />
                <button name="action_quotation_send" string="Send Job Offer" type="object" class="oe_highlight"
                        invisible="approval_stage not in ['second_approved']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />
                <button name="action_quotation_send_accepted" string="Job Offer Accepted" type="object"
                        class="oe_highlight"
                        invisible="approval_stage not in ['job_accepted']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />
                <button name="action_quotation_send_rejected" string="Job Offer Rejected" type="object"
                        class="oe_highlight"
                        invisible="approval_stage not in ['job_accepted']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />
                <button name="action_appointment_letter_send" string="Send Appointment Letter" type="object"
                        class="oe_highlight"
                        invisible="approval_stage not in ['appointment']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />
                <button name="action_appointment_letter_accepted" string="Appointment Accepted" type="object"
                        class="oe_highlight"
                        invisible="approval_stage not in ['appointment_accepted']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />

                <button name="action_appointment_letter_rejected" string="Appointment Rejected" type="object"
                        class="oe_highlight"
                        invisible="approval_stage not in ['appointment_accepted']"
                        groups="hr_recruitment.group_hr_recruitment_manager"
                />

                <button name="action_set_on_hold" type="object" string="On Hold" class="btn-secondary"
                        invisible="on_hold or approval_stage in ['job_rejected','appointment_rejected'] or is_stage_signed"
                />
                <button name="action_unhold" type="object" string="Unhold" class="btn-primary"
                        invisible="not on_hold"
                />
            </xpath>
<!--            <xpath expr="//field[@name='name']" position="before">-->
<!--                <widget name="web_ribbon" title="On Hold" bg_color="bg-warning" invisible="not on_hold"/>-->
<!--                <widget name="web_ribbon" title="Rejected" bg_color="bg-danger"-->
<!--                        invisible="approval_stage not in ['job_rejected','appointment_rejected']"/>-->
<!--                &lt;!&ndash;                <widget name="web_ribbon" title="Offer Accepted" bg_color="bg-success" invisible="not (offer_tag == 'accepted' and not is_stage_signed)"/>&ndash;&gt;-->

<!--            </xpath>-->

            <xpath expr="//div[@class='oe_title pe-0']" position="inside">
                <field name="name"
                       widget="text"
                       placeholder="e.g. Sales Manager 2 year experience"/>
            </xpath>

            <xpath expr="//field[@name='stage_id']" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath>

            <xpath expr="//field[@name='type_id']" position="after">
                <!--                <field name="document_type" invisible="1"/>-->
                <!--                <field name="offer_tag" invisible="0" readonly="1"/>-->
                <field name="is_stage_initial" invisible="1"/>
                <field name="is_stage_signed" invisible="1"/>
                <field name="job_offer_sent" invisible="1"/>
                <field name="on_hold" invisible="1"/>
                <field name="approval_stage" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='partner_phone']" position="after">
                <field name="partner_mobile"/>
            </xpath>

            <xpath expr="//field[@name='categ_ids']" position="after">
                <field name="division_id"/>
            </xpath>


            <field name="partner_name" position="attributes">
                <attribute name="string">Name as per Aadhaar</attribute>
            </field>
            <field name="partner_phone" position="attributes">
                <attribute name="string">Alternate Number</attribute>
            </field>

            <xpath expr="//sheet/notebook" position="inside">
                <page string="Professional Details" groups="hr_recruitment.group_hr_recruitment_manager">
                    <group>
                        <field name="total_experience"/>
                    </group>
                    <field name="applicant_professional_ids">
                        <list editable="bottom" delete="0">
                            <field name="sequence" readonly="1" force_save="1"/>
                            <field name="company_name"/>
                            <field name="designation"/>
                            <field name="from_date"/>
                            <field name="to_date"/>
                            <field name="years_experience"/>
                        </list>
                    </field>
                </page>
                <page string="Reference Details" groups="hr_recruitment.group_hr_recruitment_manager">
                    <field name="applicant_reference_ids">
                        <list editable="bottom" delete="0">
                            <field name="name"/>
                            <field name="phone"/>
                        </list>
                    </field>
                </page>
                <page string="Educational Details" groups="hr_recruitment.group_hr_recruitment_manager">
                    <field name="applicant_education_ids">
                        <list editable="bottom" delete="0">
                            <field name="sequence" string="S.No" readonly="1" force_save="1"/>
                            <field name="degree"/>
                            <field name="date_from"/>
                            <field name="date_to"/>
                            <field name="year_of_passing"/>
                        </list>
                    </field>
                </page>
                <page string="Checklist Documents" invisible="checklist_tab_visible == False"
                      groups="hr_recruitment.group_hr_recruitment_manager">
                    <group>
                        <field name="check_list_ids" string="Joining Check List" widget="many2many_checkboxes"/>
                    </group>
                </page>
                <page string="CTC BREAKUP">
                    <form>
                        <group>
                            <group string="CTC Breakdown (Per Annum)">
                                <field name="ctc"/>
                                <field name="basic"/>
                                <field name="hra"/>
                                <field name="other_allowance"/>
                                <field name="pf" readonly="0"/>
                                <field name="pt" readonly="0"/>
                                <field name="bonus" readonly="1" invisible="ctc_type not in 'with_bonus'"/>
                                <field name="net_take_home" readonly="1"/>
                                <field name="family_insurance"/>
                            </group>
                            <group string="Monthly Salary Computed">
                                <field name="ctc_m" readonly="0"/>
                                <field name="basic_m" readonly="1"/>
                                <field name="hra_m" readonly="1"/>
                                <field name="other_allowance_m" readonly="1"/>
                                <field name="pf_m" readonly="0"/>
                                <field name="pt_m" readonly="0"/>
                                <field name="net_take_home_m" readonly="1"/>
                            </group>
                        </group>
                    </form>
                </page>
                <page string="Offer Letter Details">
                    <form>
                        <group>
                            <field name="applicant_name"/>
                            <field name="todays_date"/>
                            <field name="date_of_joining"/>
                            <field name="ctc_offer"/>
                            <field name="designation"/>

                        </group>
                    </form>
                </page>
            </xpath>


            <xpath expr="//page[@name='application_note']/field[@name='applicant_notes']" position="before">
                <group>
                    <field name="shortlisted" readonly="approval_stage not in ['draft'] or is_stage_initial"
                           style="border-bottom: 1px solid #714B67;padding-top: 6px;margin-bottom: 10px; width:25%"
                           placeholder="    "/>

                    <field name="checklist_tab_visible"
                           invisible="1"/>
                </group>

            </xpath>
            <xpath expr="//page[@name='application_note']/group[field[@name='shortlisted']]" position="after">
                <button name="action_add_stage_remarks"
                        type="object"
                        string="Load Stages"
                        class="btn btn-primary"
                />
                <field name="stage_remark_ids" context="{'default_applicant_id': active}">
                    <list editable="bottom">
                        <field name="stage_id" readonly="1"/>
                        <field name="remarks"/>
                    </list>
                </field>
            </xpath>


        </field>
    </record>

    <record id="cmr_new_recruitments_hr_applicant_form_inherit" model="ir.ui.view">
        <field name="name">hr.applicant.form.refuse.button.inherit</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_form"/>
        <field name="arch" type="xml">
            <!-- Modify the Refuse button directly -->
            <xpath expr="//header/button[@name='archive_applicant']" position="attributes">
                <attribute name="invisible">shortlisted != 'no' or not active</attribute>
                <attribute name="class">btn-danger</attribute>
            </xpath>
        </field>
    </record>

    <record id="cmr_new_recruitments_hr_applicant_search_inherit" model="ir.ui.view">
        <field name="name">hr.applicant.form.search.inherit</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_search_bis"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='hired']" position="after">
                <filter string="On Hold" name="on_hold_filter" domain="[('on_hold','=',True)]"/>
                <filter string="Offer Accepted" name="offer_accepted_filter"
                        domain="[('approval_stage','=','job_accepted')]"/>
                <filter string="Offer Rejected" name="offer_rejected_filter"
                        domain="[('approval_stage','=','job_rejected')]"/>
            </xpath>
        </field>
    </record>

    <record id="nhcl_hr_recruitment_view_id" model="ir.ui.view">
        <field name="name">hr.applicant.form.inherit.add_field</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='recruitment_contract']/div[@class='o_row'][field[@name='salary_proposed']]"
                   position="after">
                <field name="ctc_type"/>
            </xpath>
        </field>
    </record>
</odoo>
